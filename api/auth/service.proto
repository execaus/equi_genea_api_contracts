syntax = "proto3";

package auth;

import "google/protobuf/empty.proto";

option go_package = "api/auth;auth";

import "api/auth/models.proto";

service AuthService {
  rpc GenerateToken(GenerateTokenRequest) returns (GenerateTokenResponse);
  rpc HashPassword(HashPasswordRequest) returns (HashPasswordResponse);
  rpc GeneratePassword(google.protobuf.Empty) returns (GeneratePasswordResponse);
  rpc GetClaimsFromToken(GetClaimsFromTokenRequest) returns (GetClaimsFromTokenResponse)
}

message GenerateTokenRequest {
  string id = 1;
}

message GenerateTokenResponse {
  string token = 1;
}

message HashPasswordRequest {
  string password = 1;
}

message HashPasswordResponse {
  string hash = 1;
}

message GeneratePasswordResponse {
  string password = 1;
}

message GetClaimsFromTokenRequest {
  string token = 1;
}

message GetClaimsFromTokenResponse {
  models.AuthClaims claims = 1;
}